
@model IEnumerable<WebApplication15.Models.DanhGia>

@{
    ViewBag.Title = "Danh sách đánh giá";
}

<h2 class="mb-3">Danh sách đánh giá</h2>

@using (Html.BeginForm("DeleteSelected", "DanhGias", FormMethod.Post, new { area = "Admin" }))
{
    <div class="d-flex gap-2 mb-3">
        @Html.ActionLink("➕ Thêm đánh giá", "Create", null, new { @class = "btn btn-success" })

        <button type="submit" class="btn btn-danger"
                onclick="return confirm('Bạn chắc chắn muốn xóa các đánh giá đã chọn?');">
            🗑 Xóa nhiều
        </button>
    </div>

    <table class="table table-bordered table-striped">
        <thead>
            <tr>
                <th>
                    <input type="checkbox" id="checkAll" />
                </th>
                <th>Người dùng</th>
                <th>Sản phẩm</th>
                <th>Điểm</th>
                <th>Nội dung</th>
                <th>Ngày đánh giá</th>
                <th>Thao tác</th>
            </tr>
        </thead>

        <tbody>
            @foreach (var item in Model)
            {
                <tr>
                    <td>
                        <input type="checkbox" name="ids" value="@item.MaDG" />
                    </td>

                    <td>@item.NguoiDung.HoTen</td>
                    <td>@item.SanPham.TenSP</td>
                    <td>@item.Diem</td>
                    <td>@item.NoiDung</td>
                    <td>@item.NgayDanhGia</td>

                    <td>
                        @Html.ActionLink("Xem", "Details", new { id = item.MaDG }, new { @class = "btn btn-info btn-sm" })
                        @Html.ActionLink("Sửa", "Edit", new { id = item.MaDG }, new { @class = "btn btn-warning btn-sm mx-1" })

                        @using (Html.BeginForm("Delete", "DanhGias", new { area = "Admin", id = item.MaDG }, FormMethod.Post, new { onsubmit = "return confirm('Xóa đánh giá này?');", style = "display:inline" }))
                        {
                            @Html.AntiForgeryToken()
                            <button class="btn btn-danger btn-sm">Xóa</button>
                        }
                    </td>
                </tr>
            }
        </tbody>
    </table>
}
<script>
    document.getElementById("checkAll").onclick = function () {
        var checkboxes = document.querySelectorAll("input[name='ids']");
        for (var cb of checkboxes) {
            cb.checked = this.checked;
        }
    };
</script>
